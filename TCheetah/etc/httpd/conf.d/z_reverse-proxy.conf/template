LoadModule auth_cas_module modules/mod_auth_cas.so

<IfModule mod_auth_cas.c>
    CASCookiePath /var/cache/mod_auth_cas/
    CASValidateURL https://sso.bris.ac.uk/sso/serviceValidate
    CASLoginURL https://sso.bris.ac.uk/sso/login
    CASCertificatePath /etc/httpd/CAs/
</IfModule>

Listen 50070
Listen 50030

<VirtualHost *:50070>
#if 'io-37-00' in $self.metadata.hostname
   ServerAdmin webmaster@dice-io-37-00.acrc.bris.ac.uk
   ServerName dice-io-37-00.acrc.bris.ac.uk
#elif 'io-37-01' in $self.metadata.hostname
   ServerAdmin webmaster@dice-io-37-01.acrc.bris.ac.uk
   ServerName dice-io-37-01.acrc.bris.ac.uk
#else
   ServerAdmin webmaster@$self.metadata.hostname
   ServerName $self.metadata.hostname
#end if
   DocumentRoot "/opt/websites/web/www/dummy"
   <Proxy *>
      AuthType CAS
      AuthGroupFile /etc/httpd/conf/group
      Require group hadoop
      CASScope /
      Order deny,allow
      Deny from all
      Allow from .phy.bris.ac.uk .dice.cluster
   </Proxy>
   ProxyPass / http://nn-37-00.dice.cluster:50070 nocanon
   ProxyPassReverse / http://nn-37-00.dice.cluster:50070
   ErrorLog "logs/hadoop-nn-access_log"
   CustomLog "logs/hadoop-nn-error_log" common
</VirtualHost>

<VirtualHost *:50030>
#if 'io-37-00' in $self.metadata.hostname
   ServerAdmin webmaster@dice-io-37-00.acrc.bris.ac.uk
   ServerName dice-io-37-00.acrc.bris.ac.uk
#elif 'io-37-01' in $self.metadata.hostname
   ServerAdmin webmaster@dice-io-37-01.acrc.bris.ac.uk
   ServerName dice-io-37-01.acrc.bris.ac.uk
#else
   ServerAdmin webmaster@$self.metadata.hostname
   ServerName $self.metadata.hostname
#end if
   DocumentRoot "/opt/websites/web/www/dummy"
   <Proxy *>
      AuthType CAS
      AuthGroupFile /etc/httpd/conf/group
      Require group hadoop
      CASScope /
      Order deny,allow
      Deny from all
      Allow from .phy.bris.ac.uk .dice.cluster
   </Proxy>
   ProxyPass / http://nn-37-00.dice.cluster:50030 nocanon
   ProxyPassReverse / http://nn-37-00.dice.cluster:50030
   ErrorLog "logs/hadoop-jt-access_log"
   CustomLog "logs/hadoop-jt-error_log" common
</VirtualHost>